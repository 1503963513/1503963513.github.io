(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{605:function(s,t){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAu4AAAB4CAQAAAAHtL82AAAABGdBTUEAALGPC/xhBQAAAAJiS0dEAP+Hj8y/AAAAB3RJTUUH5gUfFikvO2/n9gAADbZJREFUeNrt3X9wFOd9x/H3IrucE6UczGSAidCMGiBjixB0i6mJ7PAH7uAGXGLVM4kdU2wnkNqDhDsTz9hQm8EyuDPJtAYx9gRT7AzObypHcXChcabj8CuxvSclttoGnGpGqBMx04pTLbdLbbH94/bOd6eTdHu3e6tbPq+/dD/2ue/32d3vPftobxdERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERkpjPCDkDETwkn7Aj8k9Te6QvzEaeNxcwNO44yXeIdo9v6G+8LavORSFFxl3yJs9wUdgw++GVytddFrgk7ZhG/WWEH4AMz7AAiwnzEuWkpD9LMvLBDKdMI/TzDuZvMR7yO3meFHbqISFCcNniQW2q2tMM8buFBNxNvVNxFJLoWQ3PYMVSs2c3EGxV3EYmuudTwqD1jnpuJNyruIiIRpOIuIhJBKu4iIhGk4i4iEkH+neduJLYaS50lLGbJjDh7/gPO845x3jmXPEiEftgiIlIKX8rwirixjW3Mn1E19Bqu53oHaNnNAedAXyrsgEREqseH4p54iL1cBy3cTCOLWEQs7KwAmwtcYJBT9M6n09iR2JF8OuyYRESqpeLinvgGX4db+CKeL30QqBhLWALcy1l+wMnr+LvEJ5IPhx2ViEh1VFjcW77LXfDX3BF2HlNYzWpe4kn4essneu8OOxoRkWqo6GyZxGHjrnr2z+jSnnYH+6nHuCtxOOxIRESqoYLinvga99XxHK1h51CSVp6jDu5LfC3sSEREgld2cV+xgmfhUZaGnUHJlvIowLMrVoQdiYhI0Mou7rO6ML5QAxMyue7gC2DM6go7DhGRoJVZ3M0EN9ezI+zoPdtBPdxsJsKOQ0QkWGUWd2cTrKcu7Og9q2O9G72ISJSVWdzr7oP1Ycdels+70YuIRFlZxT3x5fE5n67R+5ss49OMz0l8Oew4RESCVN7IfVOtjtshPXZHEzMiEmllFPeVn2JdXbpE1qT11MG6lZ8KOw4RkeCUUdyvbIL1fDTsyMv2UT7vZiEiElXlTMtsoobH7eBOKam4i0iEeS7uzfU0zubGsOOuyI3Mhsbm+rDjEBEJiuerQsYaHOaHHXXF5jNIrIF/C/ZTnNv5SdiZzhgvG38WdggiVxPPI3djEZEo7ulMRESiyXNxH49McR9Xca9Z5rVhRyAy03ku7rMaolLca3Hk3kUP0MNObB9as4q000Wp11UrLQqLzaR87wfnfOK9xFst7X9cxU2xp+SekWprsRPvJ/7BrN0f3wTCc3G/UhMj9+kKz3zAaZhpUQVngL9goIT3WUD7lO9IsRnLwyebtHHE/4RSfIRl7H1/KPFa4p7mP/D/A6SWGLO5hjbnxUSq5dkVnw3607zuA2G5SufcF1CbI/e0jewJ5CbkNv/EBt+jWMNwAGN3AKOea/gcB2aPadQmQJw5xl/O+sfEoPl44vqwgwmf9/PcF6VL4+S6MDHpAdLfcSame2hus5NX2ew+/vB9Njs5zc6c5cDCxMR0D4VTdGBll8xtOX/5DQwAXTzBcVqzbU00380keFY2i9yoivfLZlJ5eX2oBxOTnYy5j9JHAB+2XawHu9xlbCzupJ873aW6ivRz+pXfAwsBGGADJmZ2fJJZZoB7eJutbCaVjWJiLrnrAuIs4HdBdvEcrnVHbc+UP2rroYsuTCxstx8zkzCWm91/uT2TOQbK5J95v5WzptJ9kaKDV9kQ2vHaVeoPWeTs4M3EWy3tNy6ovLk0O7tN5+4DmfWd2Z8sdvJ991HulhAO7zfInnLO3aYTOE2M06SA7bTxbaCH7ewjBhxhHzE6WctB2rHYxXIWAk/RxR4GaKcBE4tdHKUJm066aAdG2e8ueYR2Um7LKbbTQHN2+S4O8RjtNPI6j00xrpwP0JBwgu3cv6KDfRyliX9hICeq1CT9Ei/Iy3Tb6aGbnxPHYiuPZ1sfyGm7WA9+1u2nE2zkKLvYTRM2O/PWz3EWYDFAO/2YjFBPDLD5FUeJ0ZPt88wyc3mR7XRkI6NoLrnrIgY0cob3bg+4t+NgPGBUcEG4FzhIOzadLMDCppMeNma3xAHaWVdkqRTbWYkFvIrNCXdN9fANHgNG+WeOln2UFfT2GWGzgWXsHf9bvxp8zt0qTnFrzj6Q2TNTbAc2AsdZhZXzSnpLCOI4e3oV3SB7ot/zLg8TA1qJ8xoN7g6xjgZ39NZGnBiruI1m4JP8kbvkFpqAJtZxBptu93GMr3Le/e7rIE6MNoaxsy3HWclQzvIbeHeGjZJGGAFuoCnnucn6hSJ5gc3rdBAHTO6dou3cHgQT021n8vUDy9jkLjMEDNEIQIwvEQOWM6fIMvmK5VK4Lqr+z42ypLfIfobYBMRYxSBwJtuvW4ou9Tsa3FduxabbXVPLs7m3hbRji9+GsYlxa84zqez6jtPB69jAMtbkvbI8xIrkfeQ+xA0X+dgkL47wsbyNeUHOoyGambijjzLCwpznGxmEvPeluMRc5jAvb7njHHf/urfg/aW4CDCUDPiqxdbt/GQ3W4HH2Zj3yuT9UpgX2LxbkHtaE/lt5/egxdaCdmDi+mkoWnpsOt0oFnJpwjKFpl/HAJ97Oenjj5gSfXym4KkUhvNd58VZp8ttM5PH26x1n7mNFMNMPdMzlJc/2V5fWHSr9SZp+Ndj0TbhGOcy4/w7B6/94fvD/nzCFjppZRn78gY4uet3CJvcPSp3S4iX9Bl+817cL3DDRRZP+vIQds7GPpzzqLTyO+iOHoeyh/5x5hZ53205BzvevxmH05lUgelOezTkTGVM1S+3FTmIG2WEJsBm2O2dwrZzv6UGaSTFfg5iwoTT9/LXT74GzgBwgvQ0zAC7pl2mlHU8RKBG+QgvG4etYwCV30Exdwe2+XBLHCwhf9xeT0sFm7cU99+MGoecHyX/FfzYHtJi7GEPXe50W0Zmz4SJA6WDeXt8GDxPyzgX3NJYVDMN7olvp0mxhiFOAOlyMfUweT8pwOIEy4nRxnMMADaHWFvke285v6YfgMMlneJX6KKbSdAsLGBhwTBz8n7Jz2uADVjEWUk3NnAiO6ov1nZuD2YMuJ+Tkb9+Cs1jLO+L8qeMTLtMKet4kGDOTnPG+IBfsO1yffLP06W9cp8EXgOgB4sYq+h2+/UFAOZi8BvSB975+b9KLLumBjgcSMYypRSjzrNX/jTZaD2RLu1+sfk+NhRsx3Ha3L0uxf68Cbj4jNgSvJ8KOeROahQV4zGGMTH5T+LE2Uc3JuY0/94E2MR2THbRRRNgsps7MWllVcGERloTXezCxOQzebPZGWsYmvJsmYvArCoU92a6MWllAWZOVJP3S/G8tgCtmAzmTbHkt53fg3E62IrJIVrddm/kTnZC3voptJD0GTPr3M/7OPOKrNO27JkCQAnrOMX5iiYniorzP7zNjmsbkmuSL/b/n58NZ/IBE9jIStZi0s3D7usdPIHJdtYUvH8uMdpZQCsmh7jb74xlCs5lPqDbuCcZ732w74z/7cdYQismu/gqsZx9YCNtrMVkbd5JBsCM2BI8z+q13G/8/QZ2+xqETSdtVT2I2cVPcb7SG/CXavUuHOZXD1qcmeZHTN71MEi7zxcOW/knzgWr6GXfEg418QOT6Zhozr10iXsu/7D4V/zVvD14HrnXXZhq5F4rLrqZSL5is/SVsegO4NL5b/6seGmXq5O/R29R4fkfqk5kins15txrj9/jdpNvh52SyFXJc3G3h2b7Xtxj7Kly2hcBO+CTOMB42fu0V/n2Vu+jRGTG8zwt0z/G4GXeCDvuirzBZRjsHws7DhGRoJTzC9Uj4NN5ZyF5xc1CRCSqyijus47AK7wXduRle49jbhYiIlFVRnF/87ecGK/hsfsrjMOJN38bdhwiIsEp78JhR9ypjZp0zM1ARCS6yiruye/Ujb7F22HHXpZ+3qJuNPmdsOMQEQlSmZf8HX++Vsfux9zoRUSirMzibhyBY4yHHb1n6f8VGJqUEZGIK7O4W0lOjdXgz2b2MganrGTYcYiIBKvsOzFdacf5MS+FHb8nL/FjcK74/Qt7EZEZp+zi3tfHA/AU58LOoGTneArggb6+sCMREQlaBfdQTX6L58fZQtn3Nauq02xhHJ5PfivsSEREglfRDbKT9zvfG6OjBiZnXqKDMZzvJe8POxIRkWqoqLhD7918E57kIc6GncmkzvIQTwJ8s1e3xxGRq4T3G2QXSD6c+A/2nrzuJC3cTCOLWDTNDfWqw+YCFxjkFL0A/8uO5NNhxyQiUi0VF3dIPr3iBWMb23rn94adTVHORQ44B/pSYcchIlI9PhR36EvxJHsSW42lzhIWs8SfViv0Aed5xzjvnOs9iBN2MCIi1eVfGXZ0HoqIyExR4T9URURkJlJxFxGJIBV3EZEIUnEXEYkgFXcRia5LMBJ2DBUbcTPxRsVdRKLrHegPO4aK9buZeKPiLiKRZXTDM5ys4dH7CCd5xs3EY+5hhy7ip0SEfrCW1N7pg8RZbgo7Bh/8Mrna6yIauYtIhCVXG4/yhvcZ6xnjEm8Yj3ov7SIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIlIL/h+a6fWfWZbOhwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0wNS0zMVQxNDo0MTo0NyswODowMGdAYxoAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMDUtMzFUMTQ6NDE6NDcrMDg6MDAWHdumAAAAIHRFWHRzb2Z0d2FyZQBodHRwczovL2ltYWdlbWFnaWNrLm9yZ7zPHZ0AAAAYdEVYdFRodW1iOjpEb2N1bWVudDo6UGFnZXMAMaf/uy8AAAAYdEVYdFRodW1iOjpJbWFnZTo6SGVpZ2h0ADEyME2nybIAAAAXdEVYdFRodW1iOjpJbWFnZTo6V2lkdGgANzUwlZpzmgAAABl0RVh0VGh1bWI6Ok1pbWV0eXBlAGltYWdlL3BuZz+yVk4AAAAXdEVYdFRodW1iOjpNVGltZQAxNjUzOTc5MzA3DwKCMgAAABJ0RVh0VGh1bWI6OlNpemUAMzU2N0JCdCaubwAAAEd0RVh0VGh1bWI6OlVSSQBmaWxlOi8vL2FwcC90bXAvaW1hZ2VsYy9pbWd2aWV3Ml8xMF8xNjQ3OTMwMTYwNjk4NDAyNF80Nl9bMF24aTssAAAAAElFTkSuQmCC"},650:function(s,t,a){"use strict";a.r(t);var n=a(15),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[n("strong",[s._v("Redux 是 JavaScript 状态容器，提供可预测化的状态管理。")])]),s._v(" "),n("ul",[n("li",[s._v("store - 仓库，集中式管理存储应用中各组件共享状态的地方")]),s._v(" "),n("li",[s._v("state - 各组件需要共享的“状态”")]),s._v(" "),n("li",[s._v("action - 是一个普通对象，通常用于描述发生了什么事情。一般在 action 对象中有两个属性：{ type, payload }，type 表明动作类型，payload 表示有效载荷")]),s._v(" "),n("li",[s._v("action creator：action 创建函数，主要用于生成 action 对象，让你不必每次都手动编写 action 对象")]),s._v(" "),n("li",[s._v("reducer：是一个"),n("strong",[s._v("纯函数")]),s._v("，主要用于同步更新状态数据，这个函数会传递 state 和 action 作为参数，返回新的 state 对象")])]),s._v(" "),n("blockquote",[n("p",[s._v("Reducer 必需符合以下规则：")]),s._v(" "),n("ul",[n("li",[s._v("仅使用 "),n("code",[s._v("state")]),s._v(" 和 "),n("code",[s._v("action")]),s._v(" 参数计算新的状态值")]),s._v(" "),n("li",[s._v("禁止直接修改 "),n("code",[s._v("state")]),s._v("。必须通过复制现有的 "),n("code",[s._v("state")]),s._v(" 并对复制的值进行更改的方式来做 "),n("em",[s._v("不可变更新（immutable updates）")]),s._v("。")]),s._v(" "),n("li",[s._v("禁止任何异步逻辑、依赖随机值或导致其他“副作用”的代码")])])]),s._v(" "),n("blockquote",[n("p",[s._v("reducer 函数内部的逻辑通常遵循以下步骤：")]),s._v(" "),n("ul",[n("li",[s._v("检查 reducer 是否关心这个 action")]),s._v(" "),n("li",[s._v("如果是，则复制 state，使用新值更新 state 副本，然后返回新 state")]),s._v(" "),n("li",[s._v("否则，返回原来的 state 不变")])])]),s._v(" "),n("ul",[n("li",[s._v("dispatch：reducer() 不能直接调用。dispatch(action) 用于触发 action 调用，在内部实现对 reducer() 的调用。"),n("strong",[s._v("更新 state 的唯一方法是调用 "),n("code",[s._v("store.dispatch()")]),s._v(" 并传入一个 action 对象")]),s._v("。")])]),s._v(" "),n("h2",{attrs:{id:"三大原则"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三大原则"}},[s._v("#")]),s._v(" 三大原则")]),s._v(" "),n("p",[s._v("####单一数据源")]),s._v(" "),n("p",[n("strong",[s._v("整个应用的 state 被储存在一棵 object tree 中，并且这个 object tree 只存在于唯一一个 store 中。")])]),s._v(" "),n("h4",{attrs:{id:"state-是只读的"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#state-是只读的"}},[s._v("#")]),s._v(" State 是只读的")]),s._v(" "),n("p",[n("strong",[s._v("唯一改变 state 的方法就是触发 action，action 是一个用于描述已发生事件的普通对象。")])]),s._v(" "),n("h4",{attrs:{id:"使用纯函数来执行修改"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用纯函数来执行修改"}},[s._v("#")]),s._v(" 使用纯函数来执行修改")]),s._v(" "),n("p",[n("strong",[s._v("为了描述 action 如何改变 state tree ，你需要编写 reducers。")])]),s._v(" "),n("p",[s._v("#使用：")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i redux react-redux\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或")]),s._v("\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" redux react-redux\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("###1.  创建reducer")]),s._v(" "),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[s._v("#")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ./reducers/counter.js")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DECREMENT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INCREMENT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"../actions/constants"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * state 初始值\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" initialState "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("count")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 计数数量的状态数据")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * reducer 纯函数，用于实现状态的同步更新，返回更新后的新状态数据\n * state 更新前的状态数据 \n * action 描述发生了什么，有 type 与 payload 属性\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("reducer")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("state "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" initialState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" payload "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("switch")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INCREMENT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 加数量")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" copy "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("state "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 复制 state 值，实际应该进行深克隆")]),s._v("\n      copy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("count "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" payload"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("num "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 对复制后的副本进行更新")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" copy "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 返回更新后的新状态数据")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" state\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" reducer\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("p",[s._v("reducer() 是一个纯函数，传递 state 与 action 作为参数，返回新的 state。在函数体内部不能直接更新参数 state，而应该对参数 state 进行深克隆，然后更新克隆后的副本。")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ./reducers/index.js")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" combineReducers "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'redux'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" counter "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./counter'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 将多个独立的 reducer 最终合并为一个根 reducer")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("combineReducers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  counter\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("将各独立的 reducer 合并为一个根 reducer")]),s._v(" "),n("h2",{attrs:{id:"action-处理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#action-处理"}},[s._v("#")]),s._v(" Action 处理")]),s._v(" "),n("p",[s._v("现在我们已经确定了 state 对象的结构，就可以开始开发 reducer。reducer 就是一个纯函数，接收旧的 state 和 action，返回新的 state。")]),s._v(" "),n("h3",{attrs:{id:"定义-action-creator"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#定义-action-creator"}},[s._v("#")]),s._v(" 定义 action creator")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ./actions/counter.js")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ......")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * action creator，action创建函数，主要用于生成 action 对象\n * @returns \n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("incrementActionCreator")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INCREMENT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("payload")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("num")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("action creator 主要用于创建 action，以便实现 action 复用时少写代码")]),s._v(" "),n("h3",{attrs:{id:"创建-store"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建-store"}},[s._v("#")]),s._v(" 创建 Store")]),s._v(" "),n("p",[n("strong",[s._v("Store")]),s._v(" 就是把它们联系到一起的对象。Store 有以下职责：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("维持应用的 state；")])]),s._v(" "),n("li",[n("p",[s._v("提供 "),n("a",{attrs:{href:"https://www.redux.org.cn/docs/api/Store.html#getState",target:"_blank",rel:"noopener noreferrer"}},[n("code",[s._v("getState()")]),n("OutboundLink")],1),s._v(" 方法获取 state；")])]),s._v(" "),n("li",[n("p",[s._v("提供 "),n("a",{attrs:{href:"https://www.redux.org.cn/docs/api/Store.html#dispatch",target:"_blank",rel:"noopener noreferrer"}},[n("code",[s._v("dispatch(action)")]),n("OutboundLink")],1),s._v(" 方法更新 state；")])]),s._v(" "),n("li",[n("p",[s._v("通过 "),n("a",{attrs:{href:"https://www.redux.org.cn/docs/api/Store.html#subscribe",target:"_blank",rel:"noopener noreferrer"}},[n("code",[s._v("subscribe(listener)")]),n("OutboundLink")],1),s._v(" 注册监听器;")])]),s._v(" "),n("li",[n("p",[s._v("通过 "),n("a",{attrs:{href:"https://www.redux.org.cn/docs/api/Store.html#subscribe",target:"_blank",rel:"noopener noreferrer"}},[n("code",[s._v("subscribe(listener)")]),n("OutboundLink")],1),s._v(" 返回的函数注销监听器。")])])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// ./store/index.js\nimport { createStore } from 'redux'\nimport rootReducer from '../reducers'\n// 创建 Store 对象\nexport default createStore(rootReducer)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("调用 createStore() 并传递根 reducer 作为参数，创建 Store 仓库对象\n###利用绑定库的 Provider 保存 store")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// ./src/index.js\n// ......\nimport { Provider } from 'react-redux'\nimport store from './store'\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("通常在 src/index.js 中引入绑定库的 Provider 与 redux 创建的 store，利用 Provider 组件包裹应用中的组件，在 Provider 中使用 store 属性保存 redux 的 Store，这样，在 Provider 组件的后代组件中，就可以去连接并使用 redux 的 store 了。\n###组件中连接 store")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// ./App.jsx\n// ......\nimport { connect } from 'react-redux'\n\n/**\n * 将 store 中 state 的数据映射到组件的属性中\n * mapStateToProps 是一个函数，会传递 store 中的 state 作为参数。\n * 返回一个普通对象，该对象会被合并到组件的 props 中\n * state \n */\nconst mapStateToProps = state => ({\n  count: state.counter.count\n})\n\n/**\n * 将更新状态数据的动作映射到组件的属性中\n * mapDispatchToProps 是一个函数，会传递 dispatch 作为参数。\n * 返回一个对象，返回对象中的各字段应该是函数（方法），返回\n * 对象中的各字段也会被合并到组件的 props 中。\n */\nconst mapDispatchToProps = dispatch => ({\n  plus: () => dispatch(incrementActionCreator()),\n  minus: () => dispatch(decrementActionCreator()),\n})\n\n/* 调用 connect() 函数，在 React 组件中，连接 redux 的 store */\nconst hoc = connect(mapStateToProps, mapDispatchToProps)\n\nexport default hoc(App)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br")])]),n("p",[s._v("绑定库中的 connect() 方法主要用于在组件中连接 redux 的 store，传递 mapStateToProps 和 mapDispatchToProps 作为参数：两个参数都是函数的结构，函数中返回的对象会被合并到包裹的组件 props 属性中。")]),s._v(" "),n("p",[s._v("connect() 返回值是一个函数包裹器（HOC），调用该包裹器函数并传递组件参数，可以实现将  mapStateToProps 和 mapDispatchToProps 返回值的对象各属性合并注入到组件的操作。\n"),n("img",{attrs:{src:a(605)}}),s._v("\n配合上图，简单点就是：\n通过组件或应用调用dispatch()把action发送给reducer，reducer本质上是个函数，用它来响应发送过来的action，经过处理，把state发送给store，store是将action和reducer练到一起的对象，并给我们提供了四个方法（上方有描述），在reducer函数中必须有return返回值，更据type标识返回新的state，store 的 state 被 reducer 更新为新的 state 的时候，store.subscribe 方法里的回调函数会执行，此时就可以通知 view 去重新获取 state")])])}),[],!1,null,null,null);t.default=e.exports}}]);